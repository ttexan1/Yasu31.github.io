---
layout: post
title: 一学期丸々かけて、ハウステンボスでソフトクリームを巻くロボットを作った話。
---
![](/assets/2018/robot.jpg)
今年の2月〜8月にかけて、調理ロボットのスタートアップ企業[コネクテッドロボティクス](https://connected-robotics.com)でインターンシップをしていました。先月、会社のWantedlyのページに載せるための記事の執筆を依頼されたのですが、私がインターンとしてしていた仕事をまとめたレポートとしてちょうど良いと思い、インターンシップ中の経験などについてがっつりまとめてみました。許可を得た上で、こちらのブログにも再掲します。

* コネクテッドロボティクス
    * [ウェブサイト](https://connected-robotics.com)
    * [Wantedly](https://www.wantedly.com/companies/connectedrobotics)
* 元記事「レイカちゃんを作ったのは、実は一人の大学生」
    * [(1/3)](https://www.wantedly.com/companies/connectedrobotics/post_articles/139621)
    * (2/3)
    * (3/3)

こんにちは、利光泰徳です。東大工学部の機械情報工学科4年生で、現在はMITで交換留学をしています。2018年の2月から、半年に渡ってコネクテッドロボティクスでインターンをしていました。ソフトクリームを巻いてくれるロボット「レイカちゃん」の開発を、初期段階から納品まで担当していました。コネクテッドロボティクスでのインターンの経験、ロボットの開発の過程について紹介させていただきます。

# コネクテッドロボティクスのインターンへの応募
東大では1月から4月初めにかけて、長い冬/春休みがあります。ボーっと過ごしているのももったいないなと思い、興味のあるロボット系のインターンシップを探していたところ、コネクテッドロボティクスを見つけました。

私は、「ロボットが世界を変える」と長らく言われている割にはなかなか社会には進出していかない点にもどかしさを感じていました。研究室では、ロボットが便利になるような技術の開発を進めているものの、それが実世界で使われるためには、乗り越えなければいけない壁がたくさんあり、一回限りのデモの範疇にとらわれてしまう場合が非常に多いです。その一つの理由に、「ロバスト性」を追求する難しさがあります。「ロバスト性」とは、環境が変化したり、外乱が加わってもタスクを遂行できる能力のことです。（余談ですが、ボストンダイナミクス社が4足歩行ロボットを蹴ったりする動画を載せていますが、あれはロボットをいじめているのではありません。ロバスト性をテストしているのです。）
<div class="videowrapper"><iframe width="560" height="315" src="https://www.youtube.com/embed/aFuA50H9uek" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>

以上のような理由で、「たこ焼きロボット」を年内に発売開始しようとしているコネクテッドロボティクスのことを知ったとき、ロボットが世界に進出していく一助ができたら面白いと思い、応募させていただきました。応募の際は、私が今まで関わってきた[大小のプロジェクトをまとめたウェブサイト](https://yasu31.github.io)を送るなどして、アピールさせてもらいました。学生でも、特にエンジニアの方は自分の開発してきたものをまとめたポートフォリオページを作ると、このようなインターンに応募するときや自分の活動を紹介するときに非常に役立つと思います。

# ところで、ソフトクリームロボットの開発をしてみない？
そして無事、社長の沢登さんとインターン採用についての面接を受けることができたのですが、その時にオフィスの片隅に置かれたソフトクリームマシンを示しながら「ところで、ソフトクリームロボットの開発をしてみない？」と提案されました。これが、ソフトクリームロボットプロジェクトの始まりでした。担当のエンジニアがいるわけでもなかったので、私がソフトクリームロボットプロジェクトの開発トップとなることになりました。インターンごときが製品の開発をリードするなんて大丈夫なのか、と一抹の不安を覚えつつも、レイカちゃんプロジェクトが始まりました。

<div class="videowrapper"><iframe width="560" height="315" src="https://www.youtube.com/embed/0Q0_jMWFcIw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>

# レイカちゃんの開発秘話
インターンシップを始めたのは2018年の2月ごろでしたが、この頃は社員が4人ほどしかおらず、インターンも私だけでした。それが月を追うごとにどんどん会社の規模が大きくなっていき、社長が様々な案件やファンドを引っ張り込みつつ、8月には社員X人、インターンX人と大きく成長していました。6ヶ月の間、スタートアップが拡大していく様子を間近で見られたのは非常に勉強になりました。

いくつかのロボットを検討した結果、レイカちゃんの本体のロボットとしては[Dobot Magician](https://www.dobot.cc/dobot-magician/product-overview.html)というロボットを使うことになりました。中国の深センが開発、販売しているロボットで、10万円程度という（ロボットにしては）低価格を実現しつつ、耐久性もあるバランスの良いロボットでした。

レイカちゃんプロジェクトリードとしてのインターンシップの内容は、実に多岐に渡りました。そもそもどのようなシステムを構築するのか、ロボットを動かすPythonスクリプトのプログラミング、部品の設計と3Dプリント・レーザーカットから、電子回路の半田付けまであらゆる工程を担当していました。

どのような設計にするかや、どの部品を使うかについてはかなり私に任されていました。とはいっても、社長や他の社員に気軽に相談できる環境なので、毎日のようにその日の進捗や決めたことを報告して、了承を得たりアドバイスをもらったりしていたので、行き詰ることもそこまでなく開発を進めることができました。

ソフトクリームロボットを作っているので、実験としてソフトクリームをたくさん巻かせる必要がありました。動きの形状や、重さセンサーと組み合わせたアルゴリズムを細かく調整しつつ、オフィスで大量のソフトクリームを生み出していました。他のメンバーにもお裾分けしつつ、多い日には1日に5個くらい食べていたと思います。たこ焼きロボットのテストでたこ焼きも大量に発生するので、たこ焼きとソフトクリーム食べ放題という幸せな職場ですね。
![](/assets/2018/cr.JPG)

# ソフトクリームロボット、レイカちゃん
実は「ソフトクリームを巻くロボット」というものはレイカちゃんが初めてではなく、意外と先例がたくさんあります。日本では、安川電機の「やすかわくん」が有名ですし、シンガポールでもそのようなロボットがたくさん使われているようでした。なので、レイカちゃんをそれらのロボットとどのように差別化するかは、初期段階から意識していました。

まずは、価格差です。やすかわくんは、車の製造ラインで使われているような産業用ロボットアームを使用していて、環境コントロールされたプレハブのようなブースに設置しているので、新しく買おうとするとかなり高額になってしまいます。レイカちゃんは、ロボット本体として比較的低価格なアームロボットを使用しているので、かなり価格を抑えることができました。また、柵が不要なので、設置スペースもかなり小さく済みます。お店としては、人件費を削減したいので、その代わりとなるロボットが高額では本末転倒です。

<div class="videowrapper"><iframe width="560" height="315" src="https://www.youtube.com/embed/ahiZpXnuKnY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>

次に工夫したのが、「エンターテイメント性」です。ロボットがソフトクリームを作っているだけでは、お客さんはなかなか興味を持ってくれません。この記事を読んでいただいているあなたはロボットに何かしら興味を持っているでしょうから、街中でソフトを巻くロボットがいたら面白いと思ってくれるかもしれませんが。渋谷のロボットコーヒー店「変なカフェ」の元店長の佐藤さん（コネクテッドロボティクスのCOO）の経験からすると、目新しさで面白がってくれる人はいても、なかなか購入に繋がらなかったり、素通りされてしまうことが多かったようでした。

通行人の興味をひくためには、ロボットに「眼」をつける事が一つの方法だと考えました。カメラではなく、眼球を模した、動く部品です。ちょうど、眼球ロボットの研究をしている大学の先生と繋がることができたので、豊橋技術科学大学の林宏太郎先生との共同研究として眼球部分の開発を進めました。眼球のハードウェアは私が作り、それをどのようなアルゴリズムで動かすかを協議しながら、開発していきました。動かすプログラムを設計するときにも気をつけたのが、ロバスト性です。最初に載せた動画を見ていただくと分かるように、このロボットは前に立った人を、眼と身体を回して追いかけて来てくれます。人を認識するときは、カメラからの画像に対して顔認識処理をして、人の顔を追いかけるのが常套手段かもしれません。しかし、カメラのピントや、昼夜の明るさの違いなどにより、顔認識がうまく動いてくれない場合があるかもしれません。その上、手を振ったりしても、顔ではないので何も反応してくれません。レイカちゃんでは、以上のようなことを考えた上で、動きを認識（オプチカルフロー）してその方向を向く、という方式をとりました。

その結果、とても有機的な振る舞いが実現できました。ロボットの前を人が通りかかると、動きを認識してそちらに視線と身体を向けます。その人が興味を持って近づいて一旦止まると、動きがなくなるのでロボットはそっぽを向いてしまいます。そこで気をひこうと人が手を振ったりすると、またロボットがじっと見てくれます。自然と、人からインタラクションを引き出すロボットを作ることができました。動くものは何でも認識するので、道を歩いている鳩などもじっと見てしまうところも可愛らしいです。

ハウステンボスのご協力のもとで、ロボットの眼球動作が来場者に与える効果を調べるフィールド実験も実施することができました。こちらの結果は、林先生と共著で論文にまとめました。初めての論文も、コネクテッドロボティクスでのインターンシップの中で書いたことになります。
![](/assets/2018/htb.JPG)
# ハウステンボスへの納品
5月頃に、実際のお店にデプロイすることが決まりました。ハウステンボスのお店に、たこ焼きロボットのオクトシェフと共に、7月に開店することになりました。自分が作ったものが実世界で使われることに対する嬉しさと、うまく動かなくなったらどうしよう、間に合うかなという怖さを同時に感じながら、急ピッチで開発を進めていきました。

ここでも追求しようとしていたのが「ロバスト性」です。ロボットのカリブレーションがずれてしまってもソフトクリームを作る位置は変わらないようにするためにはどうすればいいか、もしセンサーが壊れても（少し形は崩れつつも）ソフトクリームを作り続けられるようにするためには、などを考えながらハードとソフトの両方を改善していきました。

数週間ほど前になって、眼だけでなく、動物っぽく見せるための外装もつけることになりました。コネクテッドロボティクスが相談しているデザイナーの方はいたのですが、その人の予定が合わないということで、こちらも私がデザイン・設計することになりました。Dobot Magicianのフォーム、眼の位置などを総合的に加味した上で、ハシビロコウを意識したデザインとなりました。本当にあらゆる業務をやらされるな、と思いながら、ポチポチとFusion 360という設計ソフトウェアで、くちばしや羽をデザインしていました。
![](/assets/2018/concept.JPG)
ハウステンボスへの納品は、現地に出向いて計3週間ほどかけて行いました。たこ焼きロボットと共に納品するため、計4人のメンバー（内、2人はインターン生）でハウステンボスの寮に泊まりながら、毎日店舗に出向いて、ひたすら組み立て・修正、プログラミング・デバッグを繰り返していました。実際の店舗に設置しようとすると、想定通りにいかなくて苦労をすることが多かったです。ソフトクリームロボットは、コンパクトなシステムなので干渉することはあまりありませんでしたが、たこ焼きロボットはスケールが大きく、部品もたくさんあるので全てをうまく動かそうとするのが大変そうでした。その上、どちらも急ピッチで開発したシステムなので部品の強度が足らず割れてしまうなど、苦労の連続でした。その度に東京のオフィスと連携をとりながら、強度をあげるように再設計して製造して送ってもらったり、その部品を使わないでも済むように工夫をしたりと、モグラ叩きのように問題を解決していきました。ソフトクリームロボットは、私がほとんど全て開発しているので問題が起きたらだいたい原因の検討がつき、解決策もすぐに思いつくことができたのですが、たこ焼きロボットの方は何人も関わっているので問題の原因を突き止めるのが大変でした。いくら問題が起きてもめげずに、地道に解決策を探そうとするたこ焼きチームのタフさにはもはや尊敬の念を抱きました。そして、トラブルがそもそも発生しないように十分事前にテストをすること、システムの仕組みを詳細に記述しておくことでトラブルが起きても原因が突き止められるようにすることの大切さを身をもって痛感しました。（今はたこ焼きロボットもソフトクリームロボットもそれらのトラブルを乗り越えて、しっかり動くシステムとして動いています！）
![](/assets/2018/htb-work.JPG)

# MITへの留学、そしてそれから
私は今、東大工学部の交換留学プログラムでマサチューセッツ工科大学(MIT)で一学期間（3ヶ月）を過ごしています。細かい話は[私のブログ](https://yasu31.github.io/blog)に譲るとして、かなり楽しく、刺激に溢れた日々を送っています。MITではUROP(学部生のための研究機会)というプログラムを通して学部生が最先端の研究に携わることができるのですが、学部生も一人前のエンジニアとして接してくれて、必要なことは教えてくれつつも、実際の作業もかなり任されます。コネクテッドロボティクスと同じく、学生も戦力の一員として頼りにされています。またアメリカの学生の多くは夏休みはインターンシップで企業の業務に関わりながら過ごします。そのようなインターンシップで行ったプロジェクトをアピールすることで次のインターンシップに繋げたりするのですが、私もしっかり「インターンシップでソフトクリームロボットを一から開発し、今も日本のテーマパークで動いています」とアピールして、現在所属しているMITの研究室に入ることができました(笑)。

研究室では、タコの足のような柔らかいロボットを開発しています。空気圧で駆動するので、従来のモーター駆動のロボットよりも制御が大変なかわりに、柔らかいのでぶつかってもそのまま動ける、という利点があります。ちなみに来週は、ボストンにいる日本人学生向けのお月見会で、数百人のためにたこ焼きを作ることになっています。どうやら、どこに行ってもタコやたこ焼きからは逃げられないようですね。
![](/assets/2018/mit-tu.JPG)

今は学部4年生ですが、今年はインターンシップと留学に費やしているので、来年度に卒業研究をして卒業は1年遅らせます。東大ではヒューマノイドロボットの研究室に所属しているので、そこでどのような研究ができるのかも楽しみです。その後ですか？大学院に進みますが、まだはっきりと決められていません…。ヒューマノイドの研究を東大で続けるかもしれないし、またMITに戻ってロボットの研究をするかもしれないし、はたまた別の分野・大学に進むかもしれません。

# コネクテッドロボティクスでのインターンシップ
さて、インターン生を誘い込むというのがこの一連の記事の裏テーマなので、それについても書かせていただきます。ハウステンボスの寮での夜、「インターンたちにここまで責任を負わせて大丈夫なのか」のような話を、もう一人のインターンと社長の沢登さんと話したことがありました（私は、「いざ、やばいことになった時は大人たちが対処してくれるから大丈夫かな」と呑気に考えていますが）。その時、沢登さんが「うちではインターンは社員と全く同じに扱っているから（もちろん、学業と両立させるという前提で）」といった話をしていたのが印象に残っています。確かに、しっかり給料も出るし、それに見合ったアウトプットも求められる場所だと思います。とはいえ、ロボット技術全てを知っていることは期待されていません。必要なのは、ある程度の前提知識と能力、あとは勉強していく興味と、知らないことに首を突っ込んていく無鉄砲さかと思います。

コネクテッドロボティクスでインターンをすれば、上に書いたような話とはまた別の、でも同じくらいクレイジーな経験をすることができること、請け合いです。
